{"c++":"class Solution {\r\npublic:\r\n    string minAbbreviation(string target, vector<string>& dictionary) {\r\n        len=target.size();\r\n        cand=0;\r\n        \r\n        for(auto word : dictionary) {\r\n            if(word.size()==len) {\r\n                int bit=0;\r\n                for(int i=0; i<len; ++i) {\r\n                    if(word[i]!=target[i]) {\r\n                        bit+=1<<i;\r\n                    }\r\n                }\r\n                bits.push_back(bit);\r\n                \r\n                //cout << bit << endl;\r\n                cand |= bit;\r\n            }\r\n        }\r\n        //cout << cand;\r\n        \r\n        dfs(1, 0);\r\n        \r\n        \r\n        //cout << minmask ;\r\n        \r\n        string res;\r\n        for(int i=0, pre=0; i<len; ++i) {\r\n            if(1<<i & minmask) {\r\n                if (i-pre > 0) res = res+to_string(i-pre);\r\n                pre = i+1;\r\n                res = res+target[i];\r\n            }\r\n            else if(i==len-1){\r\n                res = res+to_string(len-pre);\r\n            }\r\n        }\r\n        \r\n        return res;\r\n    }\r\nprivate:\r\n    int minlen=INT_MAX, minmask;\r\n    int len, cand=0;\r\n    vector<int> bits;\r\n    \r\n    void dfs(int pos, int mask) {\r\n        bool match=1;\r\n        int masklen=getLen(mask);\r\n        if(masklen>=minlen) return;\r\n        \r\n        //cout << \"pos\" << pos << \" mask\" << mask << endl;\r\n        \r\n        for(auto bit : bits) {\r\n            if((bit&mask)==0) {\r\n                match=0;\r\n                break;\r\n            }\r\n        }\r\n        \r\n        \r\n        //cout << match << endl;\r\n        \r\n        if(match) {\r\n            if(masklen<minlen) {\r\n                minlen=masklen;\r\n                minmask=mask;\r\n            }\r\n        }\r\n        else {\r\n            for(int b=pos; b<(1<<len); b<<=1) \r\n                if(cand & b) dfs(b<<1, mask+b);\r\n        }\r\n    }\r\n    \r\n    int getLen(int mask) {\r\n        int cnt=len;\r\n        for(int i=3; i<(1<<len); i<<=1) {\r\n            if((i & mask)==0) cnt--;\r\n        }\r\n        return cnt;\r\n    }\r\n    \r\n    \r\n};"}